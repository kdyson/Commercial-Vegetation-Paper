---
title: Woody vegetation communities on office developments are heterogenous and meaningfully
  influenced by development and landscaping choices
bibliography: ../../../bibliography.bib
output: word_document
always_allow_html: yes
---

```{r VEG-SETUP, include=FALSE, echo = FALSE}

knitr::opts_chunk$set(
    echo = FALSE,
    warning = FALSE,
    message = FALSE
    )


 # Required addt'l repositories for latex
  # tinytex::tlmgr_install("setspace")


# This chapter .Rmd code relies on two sourced R codes:
# 'vegetation_data_processing.R' and 'vegetation_data_analysis.R.' These do the
# heavy lifting before importing results here for ggplot-ifying and presenting
# in Results and Discussion.

## Data manipulation --> analysis --> Rmarkdown (this doc)


## Load sourced R codes
all.current <- TRUE

if (all.current == TRUE) {

  load(file = "vegetation_data_analysis_complete_04102019.RData")

}

if (all.current == FALSE) {

  source("vegetation_data_analysis.R")
  
}  


## Load required libraries
  library(ggplot2)
  library(rgl)
  library(png)
  library(grid)
  library(gridExtra)
  library(ggrepel)
  library(tibble)
  library(pander)
  library(vegan)
  library(dplyr)

  options(digits = 3)

    levels(vegetation.clusters$tree.cluster.name) <- c("Native", "Ornamental")
    levels(vegetation.clusters$shrub.cluster.name) <- c("Ornamental", "Native")
    
    population.covariates.subset <- population.covariates[ population.covariates$vegetation_class %in%
                                                        c("HH", "MC", "MD", "MM", "LL"), ]
    
    
    PA.tree.sp.only <- matrify.tree.sp.only
        PA.tree.sp.only[PA.tree.sp.only > 0] <- 1
    PA.shrub.site <- matrify.shrub.site
        PA.shrub.site[PA.shrub.site > 0] <- 1
        
  
```

# Highlights

* Distinct vegetation communities on office developments dominated by native or ornamental species
* Native vegetation communities less common and easily missed in small simple random sample
* Measured neighborhood- and site-scale socio-economic variables did not explain variation in vegetation communities
* Development and landscaping choices drive meaningful differences in vegetation habitat


# Abstract

Vegetation communities and the habitat they provide are significantly impacted by humans in social-ecological systems. While vegetation on residential property is increasingly well studied, these efforts have not extended to commercial land uses. I quantified the tree and shrub communities on office developments in Redmond and Bellevue, Washington, USA and evaluated whether socio-economic context or development and landscaping decisions explained more of the observed variation.



I found that both woody vegetation communities are heterogenous. 

with groups characterized by native and ornamental species, with implications for how urban ecologists sample. Additionally, I found evidence that development and landscaping choices, not socio-economic variables, are behind major divisions in vegetation groups in contrast with previous research on residential property. This impacts the quality and quantity of habitat provided by woody vegetation on office developments, with important implications for conservation and public policy. 

need to add more detail about implications.


From start of discission:

I found that woody vegetation communities on office developments in Redmond and Bellevue, Washington are heterogenous (Table \@ref(tab:TAB-site-summary-tables-tree)). 
Cluster analysis identified distinct "Native" and "Ornamental" community types for both trees and shrubs; extrapolating these to the population level suggests that sites dominated by native vegetation are less frequent.
Additionally, I found that development and landscaping actions best explain this variability. Unlike residential property, variation in vegetation communities on office developments are not driven by neighborhood or site scale socio-economic variables. 
Additionally, I found evidence that development and landscaping outcomes, not socio-economic variables, are behind major divisions in vegetation groups in contrast with residential research [@hope2003; @luck2009; @clarke2013]. 
These findings have implications for urban conservation and public policy, as well as future urban ecology research.



# Introduction

Perennial vegetation community composition, structure, and distribution are largely controlled by humans in urban ecosystems [@faeth2011; @avolio2018; @pickett2008; @gibb2002; @mullaney2015; @peters2011; @sharpe1986]. These changes to the vegetation community alter ecosystem service provision and habitat quality and quantity [@faeth2011; @byrne2007; @lehmann2014]. 

Development, landscaping, and ongoing maintenance are important milestones for management decisions about vegetation and points where landowner motivations and preferences determine vegetation community characteristics. 
In the Puget Sound region, development has replaced fire as the primary disturbance driver and precursor to new forest stands [@gibb2002; @walcott1899; @sharpe1986; @halpern1995].
The mechanisms of disturbance when clearing and grading land for development include removing vegetation, removing topsoil, and compacting soil with heavy equipment [Figure \@ref(fig:FIG-development-pic); @andres2004; @dorney1984; @mckinney2002; @grimm2017; @turner2005].
Decisions made by developers and land owners at the time of development determine the extent of disturbance and influence future site conditions.
For example, choosing to preserve existing trees determines legacy vegetation and influences stand characteristics like age and size [@dorney1984]. 


```{r FIG-development-pic, fig.cap='Commercial development project located in Redmond, WA illustrating: a. clearing the site of vegetation and b. grading the site and digging foundation.'}

	knitr::include_graphics("../images/RedmondDevelopment_hor.jpg")


```

Vegetation succession in urban ecosystems is influenced by both social vegetation management like landscaping and ongoing maintenance and ecological processes like dispersal and regeneration from seed banks [@zipperer2010process].
However, the former has become the dominant process [@grimm2017; @faeth2011; @widrlechner1990; @dorney1984; @vanheezik2014; @goodness2018]. 
Landscaping choices are made both by developers and landowners [@kendal2012].
Plants chosen for landscaping are often ornamental introduced shrubs, trees, or grasses, though using native species in landscaping is becoming more common [@vanheezik2014; @faeth2011; @germaine1998; @burghardt2009; @blair1996; @mckinney2002]. 
Once planted, these require significant ongoing maintenance inputs to arrest succession and maintain the desired aesthetic [@zipperer2010process; @faeth2011; @lebauer2008; @lepczyk2004]. 
Along with trees retained through tree preservation policies, landscape plantings represent a significant portion of the vegetation on site and of the habitat quality and quantity available to other organisms [@faeth2011; @avolio2018].

Drivers determining management decisions, actions, and outcomes are multi-scalar, and include policy, neighborhood scale social pressures, and the motivations and preferences of individual landowners [@cook2012]. 
Relevant public policies include clearing and grading permitting processes, impervious surface maximums and minimums via parking space requirements, tree protection policies, canopy cover goals, and vegetation planting policies [@young2011; @EPA2011; @delaria2008].
> These policies are frequently adopted to protect ecosystem services provided by woody vegetation, including aesthetic properties valued by the community, shade provision, rainwater interception, carbon sequestration, and primary productivity [@wolf2005; @collins2011; @elmendorf2008; @goodness2018; @conway2016; @dorney1984].

Neighborhood scale drivers include social norms and customs that influence individual behavior [@cook2012]. 
On residential properties, homeowners alter preferences for their own yards in response to the choices of nearby neighbor's yards [@nassauer2009], though assumptions about neighborhood preference are not always accurate [@peterson2012]. 
On commercial properties, owners may alter preferences based on prospective and existing tenants [@laverne2003; @levy2013].

Individual scale drivers center on current and past decision maker's preferences.
Developers for all land uses are often motivated by cost and investment decisions [@almagor2017]; mass construction paired with removing existing vegetation is purportedly cheaper, though preserving vegetation may be less expensive in the long run [@mckinney2002].
Landowner socio-economic status is often important in studies of residential property.
While these variables are aggregated to the neighborhood scale, they reflect group membership of the individual thought to serve as a proxy for commonly held attitudes and ability to manipulate their enviroment [@heynen2006].
Socio-economic status variables correlated with canopy cover and other vegetation measures include: current and historic household income [@leong2018; @hope2003; @larsen2006; @boone2009; @krafftXXXX; @sierra2017l; @clarke2013; @luck2009; @avolio2015; @heynen2006; @avolio2018], education level [@krafftXXXX; @luck2009; @kendal2012], ethnic composition [@luck2009; @grove2006data; @heynen2006; @leong2018], home value [@mills2016], home ownership [@heynen2006], and housing age [@jim1993; @sierra2017; @boone2009; @clarke2013; @avolio2018].
However, researchers that disaggregate socio-economic characteristics find that individual attitudes may be more important than these aggregated measures that serve as a proxy  [@shakeel2014; @kendal2012].
In municipal parks, education level and park age [@martin2004] were only occasionally important [@kendal2012]; these presumably influenced vegetation through neighborhood investment, advocacy, and legacy effects [@boone2009; @rigolon2018], which are less direct than decisions by homeowners on their private property. 
Individual scale drivers on other land uses are poorly studied.

Management decisions during development, landscaping, and maintenance create vegetation communities and patterns in cities [@wittig2010; @mckinney2002; @dorney1984] and also impact food webs and biodiversity as local biological communities are largely determined by available vegetation [@faeth2011; @avolio2018; @faeth2005]. 
For example, some common horticulturally-modified ornamental species like _Prunus_ L. are used less by native bees than related plants [@mach2018].
Introduced ornamentals are also unlikely to support the same insect species, or the same biomass or diversity of fauna as native habitat [@burghardt2009; @mckinney2002; @crisp1998; @rebele1994]. 
If insect populations and biomass change due to cultivated ornamental vegetation, species at higher trophic levels will also be impacted [@burghardt2009; @marzluff2001; @faeth2011]. 

Different decisions when developing and landscaping urban parcels will therefore result in different quantity and quality of habitat available to other organisms [@alberti2003; @alberti2005; @polasky2005; @rosenzweig2003]. 
For conservation efforts to be successful, the matrix in which preserves are situated, including the built environment, must provide sufficient resources for local species [@miller2002; @fahrig2001; @fischer2006; @polasky2005; @rosenzweig2003]. 
This will require working with private landowners across the urban environment to alter private actions to support conservation of locally important vegetated habitat [@goddard2010; @miller2002]. 

While the drivers and outcomes of human decision making are increasingly well studied on residential private property, other land uses have not been given the same attention [@snep2011; @bourne2013]. 
For example, commercial and industrial land uses are generally included only as independent variables in remote sensing studies of factors influencing percent canopy cover [e.g. @fan2019; @mills2016]. 
This oversight means that there are important land uses in cities for which we lack information.

In addition, there is a need for additional research where the unit of analysis maps to specific actors making decisions. 
Aggregated measures, such as vegetation transects through neighborhoods or canopy cover of a census block, cannot examine specific decisions and their outcomes because they conflate different motivations and actions [@shakeel2014?]. 
Previous research shows that these differ between actors [@kendal2012; @tenneson2013].

To fill this gap, I examined vegetation community composition on office developments in Bellevue and Redmond, Washington, USA. 
Specifically, I examined 1) the types of tree and shrub communities present on office developments and their characteristics and 2) whether aggregated or site specific socio-economic variables or development and landscaping outcomes better explained observed variation in vegetation communities.
I hypothesized that vegetation communities on office developments would be heterogeneous.
I also hypothesized that aggregated socio-economic variables found significant in explaining vegetation patterns on residential property would not be significant on office developments [commercial property; @avolio2018; @hope2003; @conway2016],
but that site-scale economic variables would. 
Finally, I hypothesized that the outcome of development and landscaping actions would better explain variation in tree and shrub community structure.

I found that vegetation communities on office developments are variable with multiple community types, and that in contrast with residential property, development and landscaping actions explain this variability better than socio-economic variables. 
The observed within land use variability has implications for how urban ecologists should approach sampling design

The observed variability in woody vegetation suggests differences in habitat quality and quantity available to other organisms within one land use and has significant implications for how urban ecologists should approach sampling site design.
Studies using a limited number of sites per land use are potentially drawing incorrect conclusions about vegetation and habitat potential based on the distribution of vegetation communities on each land use [@mcintyre2000urban].




# Materials and Methods {#CH2-methods}

## Study area and site selection

Redmond (2017 population 64,000) and Bellevue (population 144,000) are located east of Seattle in King County, Washington [@Census2017]. Both cities share a similar ecological history, a similar disturbance timeline for logging and agriculture, and have grown considerably since the opening of the Evergreen Point Floating Bridge (SR 520) in 1963. They are at similar elevations (< 500 ft) and experience the same climate and weather. 

```{r FIG-study-area-map, fig.cap='(ref:studyareacap)'}

  knitr::include_graphics("sitemap.png")


```

(ref:studyareacap) Map of office development study sites in Redmond and Bellevue, Washington. The population of office developments with High (HH), Medium Canopy (MC), Medium Diverse (MD), Medium (MM), and Low (LL) vegetation are represented with dark gray circles; excluded sites (no vegetation/LP, wetlands/WW, and under construction/XX) are represented with light gray circles. Sampled sites are shown with orange circles.

The sampling frame was limited to Redmond and Bellevue north of I-90, excluded developments in Bellevue’s central business district, and contained parcels defined as office use by the King County Assessor's Office (Figure \@ref(fig:FIG-study-area-map)). 
I grouped adjacent parcels built within three years of one another and with the same owner to create a unit of analysis based on human action not cadastral boundaries.
This initial population size was `r length(population.covariates$vegetation_class) ` developments.

I used disproportionate stratified random sampling to ensure that my sample included sites across the entire vegetation gradient.
I classified the vegetation at each potential study site into type categories using a brief visual estimation during site visits in early 2014 (Figure \@ref(fig:FIG-vegetation-types), Table \@ref(tab:TAB-vegclass)). Sites with no vegetation, with wetlands, or those that were currently under construction or undergoing landscape replanting were excluded from the analysis (`r sum(population.covariates$vegetation_class %in% c("WW", "XX", "LP")) ` sites). The remaining pool of `r sum(!(population.covariates$vegetation_class %in% c("WW", "XX", "LP")))` potential sites had no notable hydrological features on site.


```{r FIG-vegetation-types, fig.cap='(ref:vegetationtypes)'}

  knitr::include_graphics("../images/VegetationClasses.jpg")


```

(ref:vegetationtypes) Examples of each vegetation type, from top left to bottom right: High (HH); Medium Canopy (MC); Medium Diverse (MD); Medium (MM); Low (LL); no vegetation (LP; excluded); wetlands (WW; excluded).


```{r TAB-vegclass}

vegclasssum <- tibble(
`Vegetation Type` = c(
"High (HH)",
"Medium Canopy (MC)",
"Medium Diverse (MD)",
"Medium (MM)",
"Low (LL)",
"No Vegetation (LP)",
"Wetlands (WW)"
),
`Tree Cover` = c(
"30% native tree cover",
"30% native tree cover",
"15% tree cover",
"15% tree cover",
"< 10% tree cover",
"No trees",
"No requirement"
),
`Shrub Richness` = c(
"> 5 native shrub genera",
"No requirement",
"> 5 native shrub genera",
"> 5 shrub genera",
"< 5 shrub genera",
"No shrubs",
"No requirement"
),
`Strata Size` = c(
sum(population.covariates$vegetation_class == "HH"),
sum(population.covariates$vegetation_class == "MC"),
sum(population.covariates$vegetation_class == "MD"),
sum(population.covariates$vegetation_class == "MM"),
sum(population.covariates$vegetation_class == "LL"),
sum(population.covariates$vegetation_class == "LP"),
sum(population.covariates$vegetation_class == "WW")
),
`Sampled (n)` = c(5, 3, 4, 3, 5, 0, 0),
Notes = c(
" s",
" s",
" s",
" s",
" s",
"Excluded from further analysis",
"Wetland present, excluded from further analysis"
)
)

knitr::kable(vegclasssum, caption = "Vegetation type assignment criteria and strata size. Sites without vegetation and those with wetlands present were excluded from further analysis.",
             format = "pandoc", escape = TRUE)


#pander(vegclasssum)

```

I conducted stratified random sampling on sites with High (HH), Medium Canopy (MC), Medium Diverse (MD), Medium (MM), and Low (LL) vegetation. I restricted the sampling pool to sites in the 25^th^ to 85^th^ percentile of site area and the 15^th^ to 85^th^ percentile of surrounding impervious surfaces. These limits were imposed to avoid confounding factors based on the smallest strata (HH). Limiting sampling of these extremes reduced my ability to detect community differences along these gradients, though other independent variables are not covariate.

I requested property access through three mailings sent to the property owner or manager on file in the King County Assessor's database [@dyson2018]. I targeted vegetation categories underrepresented in my sample in the second and third mailings. Of 46 mailed requests, 20 (`r round(20/46 * 100, 1)`%) received no response or were not deliverable. Of the 26 (`r round(26/46 * 100, 1)`%) responses received, 6 (`r round(6/26*100, 1)`%) of were rejected and 20 (`r round(20/26*100, 1)`%) were accepted (Table \@ref(tab:TAB-vegclass)).

Commercial use of sample sites included light industrial, white collar office space, and medical/dental offices. Some sites were fully leased to tenants, while others were either partly or fully owner-occupied. Company size ranged from less than 10 to many thousand employees.



## Independent variables

Independent variables used in this analysis are defined in Table \@ref(tab:TAB-covariate-definitions). Previous research identified neighborhood socio-economic variables (median income, demographics) as significant [@hope2003; @martin2004; @walker2009; @dana2002; @grove2014; @QGIS]; these are included for comparison and to test whether surrounding residential property impacts residential developments. Commercial property variables include building quality and assessed land value. Unfortunately other measures were incorrect or incomplete. For example, some buildings received tax breaks following the 2008 recession resulting in an appraised value of 1,000 USD when the building's market value was greater than 5,000,000 USD.

I measured the height of dominant native conifers with a Nikon Forestry Pro Laser Rangefinder; I used this as a proxy measure for age as I did not collect tree cores due to liability concerns [@dyson2018]. I used historical records and site construction plans to determine whether each site had a stand of three adjacent tree predating site development. I used _Pseudotsuga menziesii_ (Mirb.) Franco, _Thuja plicata_ Donn ex D. Don, and _Tsuga heterophylla_ (Raf.) Sarg. counts to calculate native conifer density. 

After recording broad ground cover material types on paper maps, I hand digitized them in QGIS to calculate area [@QGIS]. Pervious cover types recorded include dense vegetation, dirt/litter, lawn (turf grass including moss and forb species), gravel, dense ivy, mulch, and water. I used semi-structured interviews of property owners, managers, and landscaping services along with site visits to obtain maintenance regime variables [@dexter1970; @harvey2011].
Irrigation, mulching, herbicide, and fertilizer application had only three "no" responses and thus could not be used to draw any well supported conclusions.



```{r TAB-covariate-definitions}



covariate.definitions <- tibble(
`Variable Name` = c(
"1. SOCIO-ECONOMIC SITE AND NEIGHBORHOOD VARIABLES",

"Area (acre)",
"Town",
"Building Age (in 2017)",
"Building Quality",
"Appraised Land Value per Acre",
"Impervious w/in 500 m (%)",
"Median Income",
"Percent Foreign-Born",

"2. DEVELOPMENT AND LANDSCAPING OUTCOME VARIABLES",

"Stands Predate Development",
"Median Height of Dominant Conifer",
"Density of Native Conifers",

"3. GROUND COVER MATERIAL AND MAINTENANCE REGIME",

"Ground Cover Types (%)",
"Dead Wood (count)",
"Irrigation",
"Mulch, Herbicide, and/or Fertilizer Application"
),

Definition = c(
" s",

"Site area, in acres.",
"Location, Bellevue or Redmond.",
"Age of building on site (or mean age for multiple buildings) in 2017.",
"Categorical 'quality class' assigned to buildings on the site",
"Appraised land value divided by site area. One missing assessed land values were replaced with population median land value.",
"Percent impervious surface within 500 m of the site's perimeter.",

"The median income of residents for the site's block group",
"The percent of residents born outside of the United States for the site's block group.",

" s",

"Binary variable indicating presence of a cluster of three+ trees that predate development. (Development)",
"Median height (m) of five dominant native conifer trees; age proxy. (Development)",
"Total density of Douglas-fir, western redcedar, and western hemlock (Development/Landscaping).",

" s",

"Ground cover types on site including lawn, mulch, and impervious surface.",
"Total abundance of stumps, logs, and snags on site.",
"Binary variable indicating whether irrigation is used during the summer months.",
"Binary variables (3) indicating whether landscaping crew applies mulch, herbicides, or fertilizers to a site."

),

`Data Source` = c(
" s",
"King County Assessor",
"King County Assessor",
"King County Assessor",
"King County Assessor",
"King County Assessor",
"National Land Cover Database 2011 Percent Developed Imperviousness dataset updated in 2014",

"American Community Survey 2014 5-year block group",
"American Community Survey 2014 5-year block group",

" s",
"Site survey",
"Site survey",
"Site survey",

" s",
"Site survey",
"Site survey",
"Interviews and site survey",
"Interviews and site survey"


),

`Population` = c(
" s",

paste0("Range: ", paste0(range(population.covariates.subset$acres)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(population.covariates.subset$acres)%>%round(2), "(",
       sd(population.covariates.subset$acres)%>%round(2), ")"),
paste("Bellevue:", sum(population.covariates.subset$DistrictName=="BELLEVUE", na.rm = T),
      "Redmond:", sum(population.covariates.subset$DistrictName=="REDMOND", na.rm=T)),
paste0("Range: ", paste0(range(population.covariates.subset$age.2017)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(population.covariates.subset$age.2017)%>%round(2), "(",
       sd(population.covariates.subset$age.2017)%>%round(2), ")"),

paste("Below Average:", sum(population.covariates.subset$BldgQuality_lookup %in%
                                c("LOW COST", "LOW/AVERAGE"), na.rm=T),
      "Average:", sum(population.covariates.subset$BldgQuality_lookup=="AVERAGE", na.rm = T),
      "Average/Good:", sum(population.covariates.subset$BldgQuality_lookup=="AVERAGE/GOOD", na.rm=T),
      "Good:", sum(population.covariates.subset$BldgQuality_lookup=="GOOD", na.rm=T),
      "Good/Excellent:", sum(population.covariates.subset$BldgQuality_lookup=="GOOD/EXCELLENT", na.rm=T)
      ),

paste0("Range: ", paste0(range(population.covariates.subset$landrentperacre)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(population.covariates.subset$landrentperacre)%>%round(2), "(",
       sd(population.covariates.subset$landrentperacre)%>%round(2), ")"),
paste0("Range: ", paste0(range(population.covariates.subset$dissolved_parcel_500m_buffer_impervious_500m_mean*100)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(population.covariates.subset$dissolved_parcel_500m_buffer_impervious_500m_mean*100)%>%round(2), "(",
       sd(population.covariates.subset$dissolved_parcel_500m_buffer_impervious_500m_mean*100)%>%round(2), ")"),
paste0("Range: ", paste0(range(population.covariates.subset$MedianHouseholdIncome_B19013e1)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(population.covariates.subset$MedianHouseholdIncome_B19013e1)%>%round(2), "(",
       sd(population.covariates.subset$MedianHouseholdIncome_B19013e1)%>%round(2), ")"),
paste0("Range: ", paste0(range(population.covariates.subset$Proportion_ForeignBorn_B99051e5*100)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(population.covariates.subset$Proportion_ForeignBorn_B99051e5*100)%>%round(2), "(",
       sd(population.covariates.subset$Proportion_ForeignBorn_B99051e5*100)%>%round(2), ")"),

" ",

"NA",
"NA",
"NA",

" ",

"NA",
"NA",
"NA",
"NA"
    
),

`Sample` = c(
" ",

paste0("Range: ", paste0(range(sample.covariates$acres)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(sample.covariates$acres)%>%round(2), "(",
       sd(sample.covariates$acres)%>%round(2), ")"),
paste("Bellevue:", sum(sample.covariates$DistrictName=="BELLEVUE", na.rm = T),
      "Redmond:", sum(sample.covariates$DistrictName=="REDMOND", na.rm=T)),
paste0("Range: ", paste0(range(sample.covariates$age.2017)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(sample.covariates$age.2017)%>%round(2), "(",
       sd(sample.covariates$age.2017)%>%round(2), ")"),

paste("Below Average:", sum(sample.covariates$BldgQuality_lookup %in%
                                c("LOW COST", "LOW/AVERAGE"), na.rm=T),
      "Average:", sum(sample.covariates$BldgQuality_lookup=="AVERAGE", na.rm = T),
      "Average/Good:", sum(sample.covariates$BldgQuality_lookup=="AVERAGE/GOOD", na.rm=T),
      "Good:", sum(sample.covariates$BldgQuality_lookup=="GOOD", na.rm=T),
      "Good/Excellent:", sum(sample.covariates$BldgQuality_lookup=="GOOD/EXCELLENT", na.rm=T)
      ),

paste0("Range: ", paste0(range(sample.covariates$landrentperacre)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(sample.covariates$landrentperacre)%>%round(2), "(",
       sd(sample.covariates$landrentperacre)%>%round(2), ")"),
paste0("Range: ", paste0(range(sample.covariates$dissolved_parcel_500m_buffer_impervious_500m_mean*100)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(sample.covariates$dissolved_parcel_500m_buffer_impervious_500m_mean*100)%>%round(2), "(",
       sd(sample.covariates$dissolved_parcel_500m_buffer_impervious_500m_mean*100)%>%round(2), ")"),
paste0("Range: ", paste0(range(sample.covariates$MedianHouseholdIncome_B19013e1)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(sample.covariates$MedianHouseholdIncome_B19013e1)%>%round(2), "(",
       sd(sample.covariates$MedianHouseholdIncome_B19013e1)%>%round(2), ")"),
paste0("Range: ", paste0(range(sample.covariates$Proportion_ForeignBorn_B99051e5*100)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(sample.covariates$Proportion_ForeignBorn_B99051e5*100)%>%round(2), "(",
       sd(sample.covariates$Proportion_ForeignBorn_B99051e5*100)%>%round(2), ")"),

" s",

paste("Yes:", sum(management.landscaping$stand.predate.development=="yes", na.rm = T),
      "No:", sum(management.landscaping$stand.predate.development=="no", na.rm=T)),

paste0("Range: ", paste0(range(management.landscaping$height.m.median)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(management.landscaping$height.m.median)%>%round(2), "(",
       sd(management.landscaping$height.m.median)%>%round(2), ")"),
paste0("Range: ", paste0(range(management.landscaping$tree.conifer.nat.dens)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(management.landscaping$tree.conifer.nat.dens)%>%round(2), "(",
       sd(management.landscaping$tree.conifer.nat.dens)%>%round(2), ")"),

" s",

paste("Mean (SD) Grass:", mean(dens.matrify.gc$grass*100)%>%round(2),
            "(",
            sd(dens.matrify.gc$grass*100)%>%round(2), ");",
      "Impervious:", mean(dens.matrify.gc$impervious.sqft*100)%>%round(2),
            "(",
            sd(dens.matrify.gc$impervious.sqft*100)%>%round(2), ");",
      "Dirt/Litter:", mean(dens.matrify.gc$dirt.litter*100)%>%round(2),
            "(",
            sd(dens.matrify.gc$dirt.litter*100)%>%round(2), ")"),


paste0("Range: ", paste0(range(management.landscaping$height.m.median)%>%round(2), collapse = "-"),
       "; Mean(SD): ", mean(management.landscaping$height.m.median)%>%round(2), "(",
       sd(management.landscaping$height.m.median)%>%round(2), ")"),

paste("Yes:", sum(management.landscaping$Irrigation=="yes", na.rm = T),
      "No:", sum(management.landscaping$Irrigation=="no", na.rm=T)),

paste("Mulch Y/N:", paste(sum(management.landscaping$Mulch=="yes", na.rm = T),
                           sum(management.landscaping$Mulch=="no", na.rm=T), 
                           sep = "/"),
      "Herbicide Y/N:", paste(sum(management.landscaping$Herbicide=="yes", na.rm = T),
                           sum(management.landscaping$Herbicide=="no", na.rm=T), 
                           sep = "/"),
      "Fertilizer Y/N:", paste(sum(management.landscaping$Fertilizer=="yes", na.rm = T),
                           sum(management.landscaping$Fertilizer=="no", na.rm=T), sep = "/")
    )

)
)


knitr::kable(covariate.definitions,
       caption = '(ref:definition)',
       format = "pandoc", escape = TRUE, format.args = list(decimal.mark = ',', big.mark = "'"))
 


```


(ref:definition) Definition of independent variables used in PERMANOVA and correlation analysis [@taxDB; @KCDB; @ACS5yr; @xian2011; @homer2015]. Summary statistics for independent variables for both the population of office developments in Redmond and Bellevue and the sample of sites studied (`r sum(population.covariates$vegetation_class %in% c("WW", "XX", "LP")) ` and 20 sites, respectively). Median income ($) and proportion foreign born are included to compare patterns in commercial developments with patterns found significant in residential research.


## Vegetation data collection

I censused vegetation communities during the summer of 2015.
Saplings with DBH < 3" were excluded.
Each tree and shrub was identified to species or genus using traditional identification methods and consultation with experts at the Center for Urban Horticulture at University of Washington [@sibley2009; @dirr1997hardy; @dirr2009manual].
Horticultural cultivars are difficult to accurately identify [@hope2003]. 
Thus, some tree and shrub species were grouped at the genus level due to the abundance of very similar cultivars in the landscaping trade, including _Malus_ Mill. sp [@sierra2017].
One subspecies was identified separately; _Prunus laurocerasus_ var. _zabeliana_ is a dwarf variant of _Prunus laurocerasus_ (.5 m vs. 3 m) which fulfilled a very different aesthetic and ecological role.
 
Following @daniels2006yds, I grouped conifers under 2 m into a broad class of dwarf conifer species. 
`r sum(matrify.tree.sp.only[ , colnames(matrify.tree.sp.only) %in% c("cedar.1", "cedar.2", "unknown.broadleaf.1", "unknown.broadleaf.2", "unknown.broadleaf.3", "unknown.broadleaf.4", "unknown.broadleaf.5", "unknown.broadleaf.6")]) ` individual trees (`r 100*(sum(matrify.tree.sp.only[ , colnames(matrify.tree.sp.only) %in% c("cedar.1", "cedar.2", "unknown.broadleaf.1", "unknown.broadleaf.2", "unknown.broadleaf.3", "unknown.broadleaf.4", "unknown.broadleaf.5", "unknown.broadleaf.6")])/sum(matrify.tree.sp.only)) `%) and `r sum(matrify.shrub.site[ , 71:79]) ` shrubs (`r 100*(sum(matrify.shrub.site[ , 71:79])/sum(matrify.shrub.site) ) `%) could not be identified; these were given a unique identifier code for multivariate community analysis.

I assigned tree and shrub genera to one of three provenance categories---native, non-native, or ambiguous [@USGSplants; @USDAplants].
The ambiguous category was used for genera including both native and non-native cultivated species that are difficult to distinguish, and/or frequently interbred and sold as crosses.
For example, some _Mahonia_ Nutt. sp. are native (_M. aquifolium_ (Pursh) Nutt. and _M. nervosa_ (Pursh) Nutt.), while others originate in Asia (_Mahonia japonica_ (Thumb.) DC.) and many hybrids are bred and sold by nurseries (e.g. _Mahonia x media_ "Charity" Brickell).


## Data Analysis

Prior to flexible beta clustering and PERMANOVA analysis I standardized tree and shrub abundance data and ground cover area by total site area in acres.
This transformation preserves parcel boundaries as the unit of analysis and reflects developer and landowner actions during and following development that determine the amount of impervious surface and pervious area, the number of trees preserved, and the number of trees and shrubs planted.
Between site standardization (e.g. Wisconsin standardization) was not needed as the vegetation on all sites was completely censused. 

### Identifying and describing vegetation clusters on office developments

I used flexible beta clustering and indicator species analysis to delineate vegetation community clusters on office developments.
I used the agnes {vegan} function with beta = -0.5 to produce an ecologically interpretable dendrogram with minimal chaining [@mccune2002; @dufrene1997; @milligan1989; @breckenridge2000; @vegan]. 
I performed indicator species analysis, which assesses the predictive values of species as indicators of the conditions at site groups, using multipatt {indicspecies} [@decaceres2010; @indicspecies; @decaceres2013]. 
I ran the permutation-based function 100 times and took the mean of the indicator statistics generated for each species [@dysoncode]. 
I used proportions to extrapolate group membership as determined by flexible beta clustering to the entire population of office developments in the study area based on corresponding pre-assigned vegetation classes.
I modeled the example population distribution of total tree abundance per site using mean observed tree abundance for each vegetation class and adding one standard deviation of random noise to each point, also based on vegetation class.

After identifying vegetation community clusters, I used simple univariate PERMANOVA models to test continuous variables differed between groups and Pearson's Chi-squared test to test if categorical variables differed [adonis2 {vegan} and chisq.test {stats}; @vegan]. 
PERMANOVA is a permutation based implementation of ANOVA/MANOVA that avoids assumptions about underlying distributions of community structure and can be used with non-Euclidian distance matrices [@anderson2001]. 
Bartlett tests of homogeneity found no difference between group variances (bartlett.test {stats}).


### Explaining variation in tree and shrub community structure

I analyzed the tree and shrub communities separately to detect if they responded differently to socio-economic gradients or development and landscaping outcomes. 
Additionally, the development and landscaping outcome variables are derived from measurements of the tree community.
To avoid regressing the tree community against a measure of itself, I used non-metric multidimensional scaling (NMDS) to evaluate relationship between these variables and the tree community, and PERMANOVA for all other tests.

NMDS is a rank-based ordination technique that is robust to data without identifiable distributions, can be used with any distance or dissimilarity measure; here I used Bray-Curtis [@mccune2002]. 
I used 100 repetitions of the metaMDS {vegan} implementation of NMDS to find a stable minima [@vegan; @mccune2002]. To determine the relationship between development and landscaping outcome variables and the tree community, I used convex hull plots and fitted environmental vectors [ordiplot and envfit {vegan}; @vegan].

I used a multi-step approach to avoid transforming independent variables or using ordination to collapse related variables, as these actions make results less interpretable for urban planners and other professionals without back transformation.
I first tested each independent variable individually in a simple multivariate PERMANOVA model
(Table \@ref(tab:TAB-covariate-definitions).
To ensure differences in categorical variables were due to location and not dispersion, I used ANOVA to test for significant differences in dispersion [anova {stats} and betadisper {vegan}; @vegan].
I then constructed models using all variables with significant pseudo-_F_ values in all possible single and multiple variable model combinations. Significance was assessed at the $\alpha \leq$ 0.05 level following Holm-Bonferroni correction for multiple comparisons.
I used a custom AICc function based on residual sums of squares to compare models and identify those with the best support [@dysoncode].



# Results and Discussion {#CH2-results}

Woody vegetation communities on office developments in Redmond and Bellevue, Washington are heterogenous (Table \@ref(tab:TAB-site-summary-tables-veg)). 
Cluster analysis identified distinct "Native" and "Ornamental" community types for both trees and shrubs; extrapolating these to the population level suggests that sites dominated by native vegetation are less frequent.
Additionally, I found that development and landscaping actions best explain this variability. Unlike residential property, variation in vegetation communities on office developments are not driven by neighborhood or site scale socio-economic variables. 
Additionally, I found evidence that development and landscaping outcomes, not socio-economic variables, are behind major divisions in vegetation groups in contrast with residential research [@hope2003; @luck2009; @clarke2013]. 
These findings have implications for urban conservation and public policy, as well as future urban ecology research.

## Observed woody vegetation communities

I recorded a total of `r sum(matrify.tree.sp.only)` individual trees and  `r sum(matrify.shrub.site)` individual shrubs from `r length(unique(tree.native$tree.species)) ` and `r length(unique(shrub.native$shrub.species)) ` taxonomic groups respectively (Supplemental Tables 1 & 2). 
Only _Rhododendron sp._ were found on all 20 sites surveyed. Four tree species and nine shrub species were found on more than half of all office developments, with `r sum(colSums(PA.tree.sp.only) == 1) ` tree species and `r sum(colSums(PA.shrub.site) == 1) ` shrub species found only once. 

Native tree species accounted for `r 100 * (sum(matrify.tree.sp.only.native) / sum(matrify.tree.sp.only)) `% of total individuals observed, and three of the top five most abundant species. On average, native tree species accounted for `r 100 * mean(rowSums(matrify.tree.sp.only.native) / rowSums(matrify.tree.sp.only)) `% of the trees found on each office development, though sites varied widely with 0%--99% native tree stems.
_Pseudotsuga menziesii_ was by far the most abundant tree species, with `r 100*( 746 / sum(matrify.tree.sp.only))`% of observed individuals. _Thuja plicata_ (`r 100*( 245 / sum(matrify.tree.sp.only))`%), _Acer macrophyllum_ (`r 100*( 218 / sum(matrify.tree.sp.only))`%), _Acer rubrum_ (`r 100*( 132 / sum(matrify.tree.sp.only))`%), and _Acer platanoides_ (`r 100*( 100 / sum(matrify.tree.sp.only))`%) complete the top five. _Prunus sp._ and _Alnus rubra_ were both widespread species (found on 12 and 9 sites, respectively) but never abundant on any one site.
`r sum(colSums(matrify.tree.sp.only) < 11)` species were observed fewer than 10 times across all office developments, and `r sum(colSums(matrify.tree.sp.only) < 2)` species were observed only once.

In contrast, non-native shrub species accounted for the majority of individual shrubs observed, with native shrubs accounting for only `r 100 * (sum(matrify.shrub.site.native) / sum(matrify.shrub.site))`% of total shrubs observed.
On average, native shrubs accounted for `r 100 * mean(rowSums(matrify.shrub.site.native) / rowSums(matrify.shrub.site)) `% of the shrubs observed at each office development, and never more than `r 100 * max(rowSums(matrify.shrub.site.native) / rowSums(matrify.shrub.site)) `% of individual shrubs. 
The two most abundant shrub species were the native _Gaultheria shallon_ (`r 100 * 1267 / sum(matrify.shrub.site)`%), which frequently occurs in low, dense mats, and _Berberis Mahonia gp._ (`r 100 * 1007 / sum(matrify.shrub.site)`%) which is comprised of native, introduced, and hybrid species.
The rest of the top five most abundant shrub species were all non-native, including _Rhododendron sp._ (`r 100 * 612 / sum(matrify.shrub.site)`%), _Prunus laurocerasus var. zabeliana_ (`r 100 * 581 / sum(matrify.shrub.site)`%), and _Cornus sericea_ (`r 100 * 419 / sum(matrify.shrub.site)`%).
`r sum(colSums(matrify.shrub.site) < 11)` species were observed fewer than 10 times across all office developments, and `r sum(colSums(matrify.shrub.site) < 2)` were observed only once.

```{r beta-calc}

tree.sorensen <- vegdist(matrify.tree.sp.only, binary = TRUE) # take mean for sorensen index
shrub.sorensen <- vegdist(matrify.shrub.site, binary = TRUE) #ditto

tree.z.beta <- betadiver(matrify.tree.sp.only, "z")
shrub.z.beta <- betadiver(matrify.shrub.site, "z")


beta.tibble <- tibble(Metric = c("Tree Sorensen", "Tree Arrhenius Model z", "Shrub Sorensen", "Shrub Arrhenius Model z"),
                      Minimum = c(min(tree.sorensen), min(tree.z.beta), min(shrub.sorensen), min(shrub.z.beta)),
                      Maximum = c(max(tree.sorensen), max(tree.z.beta), max(shrub.sorensen), max(shrub.z.beta)),
                      Mean = c(mean(tree.sorensen), mean(tree.z.beta), mean(shrub.sorensen), mean(shrub.z.beta)),
                      `S.D.` = c(sd(tree.sorensen), sd(tree.z.beta), sd(shrub.sorensen), sd(shrub.z.beta)),
                      Median = c(median(tree.sorensen), median(tree.z.beta), median(shrub.sorensen), median(shrub.z.beta)))

```

Measures of tree and shrub abundance, density, and diversity varied substantially between sites (Table \@ref(tab:TAB-site-summary-tables-veg)).
In general, total species richness and native species richness were positively correlated (Pearson's Correlation for Tree:  `r cor(descriptive.stats.site$tree.native.richness, descriptive.stats.site$tree.sp.richness)`; Shrub: `r cor(descriptive.stats.site$shrub.native.richness, descriptive.stats.site$shrub.sp.richness)`), though four sites with above average species richness had three or fewer native species planted. Remnant large native conifer abundance, primarily _Pseudotsuga menziesii_, greatly contributed to sites with greater tree abudnance (Pearson's :`r cor(descriptive.stats.site$tree.conifer.L.native, descriptive.stats.site$tree.site.abundance)`); consequently Shannon diversity was generally lower on sites with more native trees (Pearson's: `r cor(descriptive.stats.site$tree.conifer.native, descriptive.stats.site$tree.Shannon)`).


```{r TAB-site-summary-tables-veg}

diver.metrics <- data.frame(matrix(unlist(pretty.descriptive.stats.site),
                          nrow = nrow(pretty.descriptive.stats.site),
                          byrow = FALSE),
                   stringsAsFactors = FALSE)
colnames(diver.metrics) <- colnames(pretty.descriptive.stats.site)
diver.metrics <- rbind(diver.metrics,beta.tibble)

diver.metrics[, 2:6] <- lapply(diver.metrics[, 2:6], as.numeric) %>%
                    lapply(., round, digits = 2)

  knitr::kable(diver.metrics[c(2:4, 6:7, 8,9, 17, 35:36,5, 18:20, 22,23,21,24:25, 37:38) , ],
               row.names = FALSE,
               caption = "Metrics for tree and shrub communities on sampled office developments. H' is Shannon's diversity index [@shannon1949], effective species richness = exp(H') [@jost2006], density = individuals per acre.",
               format = "pandoc", escape = TRUE,
               format.args = list(decimal.mark = '.', big.mark = ","))

  
  

```

Overall, these measures are within the ranges reported by other urban ecology studies, though differences in methodology and particularly the use of small plots [e.g. @clarke2013] and remote sensing [e.g. @luck2009] make comparison more difficult.
The most abundant tree species on office developments matched well with similar studies on residential properties in western Washington [@tenneson2013; @mills2016]. 
Outside of this region, the percent of natives present is higher for trees in my study than elsewhere, though similar for shrubs [@martin2004; @sierra2017; @jim1993].
The observed pattern of a few highly abundant species with a long tail of rare species is also consistent with other studies of urban land use [@thompson2004; @jim1993; @sierra2017].
Tree densities were less than observed on residential property, though maximum tree density was similar [@shakeel2014; @tenneson2013].
Measures of diversity were also generally lower than residential property [@clarke2013; @martin2004]. 
However, the number of species observed was comparable to other commercial land uses and in city parks [@clarke2013; @martin2004] though lower than residential land uses [@clarke2013; @sierra2017; @martin2004; @jim1993]. 
Measures of beta diversity, suggesting low similarity between locations, was also consistent [@sierra2017].



## Divergent vegetation groups found on office developments

I identified two groups of tree and shrub vegetation based on flexible beta cluster analysis (flexible beta = -0.5; agglomerative coefficients of `r beta.5.tree$ac ` and `r beta.5.shrub$ac ` respectively; Table \@ref(tab:TAB-groupabund)). Using indictor species analysis, I found the Native Tree group (11 sites) is characterized by _Thuja plicata_, _Acer macrophyllum_ Pursh, _Arbutus menziesii_ Pursh, and _Alnus rubra_ Bong, while the Ornamental Tree group (9 sites) is characterized by _Acer rubrum_ L. The Native Shrub group (11 sites) is characterized by _Acer circinatum_ Pursh, _Corylus sp._ L., _Gaultheria shallon_ Pursh, _Mahonia sp._ Nutt., _Symphoricarpos sp._ Duham., and _Vaccinium parvifolium_ Sm., and the Ornamental Shrub group (9 sites) by _Prunus laurocerasus_ L. 


```{r TAB-groupabund}

tree.native$tree.star <- paste0(tree.native$tree.scientific.update,
                                ifelse(
                                    tree.native$tree.species %in%
                                        colnames(matrify.tree.sp.only.native),
                                    "*",
                                    "" )
                                )


names(tree.cluster.native) <- tree.native[ match(names(tree.cluster.native),
                                                 tree.native$tree.species),
                                           "tree.star"] 

names(tree.cluster.orndec) <- tree.native[ match(names(tree.cluster.orndec),
                                                 tree.native$tree.species),
                                           "tree.star"]


names(shrub.cluster.native) <- paste0(names(shrub.cluster.native),
                                      ifelse(
                                      names(shrub.cluster.native) %in%
                                      colnames(matrify.shrub.site.native),
                                      "*",
                                      ""
                                      ))

names(shrub.cluster.cultiv) <- paste0(names(shrub.cluster.cultiv),
                                      ifelse(
                                      names(shrub.cluster.cultiv) %in%
                                      colnames(matrify.shrub.site.native),
                                      "*",
                                      ""
                                      ))

temp <- tibble(
    `Rank` = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"),
    `Native Tree Group` = paste(names(head(
        tree.cluster.native, 10)),
        " (",
        (head(tree.cluster.native, 10) / 11) %>% round(1),
        ")" , sep = ""),
    `Ornamental Tree Group` = paste(names(head(
        tree.cluster.orndec, 10)),  " (",
        (head(tree.cluster.orndec, 10) / 9) %>% round(1),
        ")" , sep = ""),
    `Native Shrub Group` = paste(names(head(
        shrub.cluster.native, 10)), " (",
        (head(shrub.cluster.native, 10) / 11) %>% round(1),
        ")" , sep = ""),
    `Ornamental Shrub Group` = paste(names(head(
        shrub.cluster.cultiv, 10)), " (",
        (head(shrub.cluster.cultiv, 10) / 9) %>% round(1),
        ")" , sep = "")
    )

knitr::kable(temp,
             caption = "Rank abundance of tree and shrub taxa for each community group identified by flexible-beta analysis. Asterisk indicates native tree and shrub species.", 
             row.names = FALSE,
             format = "pandoc", escape = TRUE, format.args = list(decimal.mark = ',', big.mark = "'"))


  
```


```{r CALC-mean-calcs}

shrub.ac.mean <- merge(sample.covariates, vegetation.clusters,
                     by = "SiteName",
                     sort = FALSE) %>% 
    group_by(shrub.cluster.name) %>%
    summarise_if(is.numeric, .funs = mean)

tree.ac.mean <- merge(sample.covariates, vegetation.clusters,
                     by = "SiteName",
                     sort = FALSE) %>% 
    group_by(tree.cluster.name) %>%
    summarise_if(is.numeric, .funs = mean)
 
    
shrub.ml.mean <- merge(vegetation.clusters, management.landscaping,
                     by.x = "SiteName", by.y= "Site",
                     sort = FALSE) %>%
    mutate(tot.abund = rowSums(matrify.shrub.site)) %>%
    group_by(shrub.cluster.name) %>%
    summarise_if(is.numeric, .funs = mean)

tree.ml.mean <- mutate(management.landscaping,
                       tot.abund = rowSums(matrify.tree.sp.only)) %>%
    group_by(tree.cluster.name) %>%
    summarise_if(is.numeric, .funs = mean)    


shrub.gc.mean <- merge(dens.matrify.gc, vegetation.clusters,
                     by.x = 0, by.y = "SiteName",
                     sort = FALSE) %>% 
    group_by(shrub.cluster.name) %>%
    summarise_at(.vars = c("dirt.litter",
                            "grass", "mulch", "impervious.sqft"
                            ), .funs = mean)

tree.gc.mean <- merge(dens.matrify.gc, vegetation.clusters,
                     by.x = 0, by.y = "SiteName",
                     sort = FALSE) %>% 
    group_by(tree.cluster.name) %>%
    summarise_at(.vars = c("dirt.litter",
                            "grass", "mulch", "impervious.sqft"
                            ), .funs = mean)


```


In addition to the origin of tree and shrub species, the two groups are distinct in the average abundance of trees and shrubs per site (Native Tree mean = `r tree.ml.mean[1,'tot.abund'] `,
Ornamental Tree mean = `r tree.ml.mean[2,"tot.abund"] `
with Pr(>_F_) = `r count.tree[1,5] `; 
Native Shrub mean = `r shrub.ml.mean[2,"tot.abund"] `,
Ornamental Shrub mean = `r shrub.ml.mean[1,"tot.abund"] `
with Pr(>_F_) = `r count.shrub[1,5] `
). 
The median height of dominant native conifers was also significantly different between Native and Ornamental clusters for trees and shrubs (tree mean values = `r tree.ml.mean[1,"height.m.median"] ` m
and `r tree.ml.mean[2,"height.m.median"] ` m
with Pr(>_F_) = `r mheight.tree[1,5] `;
shrub mean value = `r shrub.ml.mean[2,"height.m.median"] ` m
and `r shrub.ml.mean[1,"height.m.median"]` m
with Pr(>_F_) = `r mheight.shrub[1,5]`).
However, there was no difference in area between Native and Ornamental clusters for either trees or shrubs (
tree Pr(>_F_) = `r area.tree[1,5]`;
shrub Pr(>_F_) = `r area.shrub[1,5]`). 

Other differences between the groups are also of interest. Associated ground cover on Native and Ornamental Tree sites differed significantly for percent impervious surface cover on site but not grass or combined dirt and liter cover. Native and Ornamental Shrub sites only differed for percent grass cover. Dead wood was significantly more abundant on Native Tree sites than Ornamental Tree sites 
(mean value = `r tree.ml.mean[1,"dead.wood"]`
and `r tree.ml.mean[2,"dead.wood"]`
with Pr(>_F_) = `r dw.tree[1,5]`),
but not between shrub site groups. As irrigation, mulching, herbicide, and fertilizer application were near universal and had only three "no" responses, I cannot draw any well supported conclusions.

There was also substantial co-occurance between Native and Ornamental groups. Of the 20 office developments surveyed, nine sites belong to both Native tree and shrub community groups, and seven sites belong to both Ornamental tree and shrub community groups.
This suggests that the sequential decisions made concerning tree preservation, tree plantings, and shrub plantings that contribute to tree and shrub community composition are related, though more research is needed. 
Together, these divergent vegetation communities, with their observed differences in species composition and between group differences in abundance, age, and ground cover, coupled with the observed high turnover (beta diversity) support the conclusion that woody vegetation communities on office developments are heterogenous.

In the population of 405 office developments studied here, the Native Tree and Shrub communities are more rare than Ornamental Tree and Shrub communities. More precisely, extrapolation suggests there are approximately 70 Native Tree and 335 Ornamental Tree developments for a ratio of around 1:5 developments, and 152 Native Shrub and 253 Ornamental Shrub developments for a ratio of around 2:5 developments (Table \@ref(tab:TAB-confusion-matrix)). Note the accuracy of these estimates will be influenced by the medium vegetation group (MM), as it is large and proportionally undersampled, and the relatively small sample size.

```{r TAB-cm1}


t1 <- tibble(`Tree Cluster` = c("Native", "Ornamental"),
          LL = c(1,4),
          MM = c(0,3),
          MD = c(2,2),
          MC = c(3,0),
          HH = c(5,0))



```


```{r TAB-confusion-matrix}

t2 <- tibble(`Shrub Cluster` = c("Native", "Ornamental"),
          LL = c(0,5),
          MM = c(1,2),
          MD = c(3,1),
          MC = c(2,1),
          HH = c(5,0))  

knitr::kable(list(t1,t2),
             caption = "Category overlap between visually estimated vegetation class and Native and Ornamental groups derived from flexible-beta clusteringfor trees and shrubs. LL = low vegetation; MM = medium vegetation; MD = medium w/diverse shrubs; MC = medium w/canopy cover; HH = high vegetation",
             format = "pandoc", escape = TRUE, format.args = list(decimal.mark = ',', big.mark = "'"))


```



## Socio-economic variables poorly explain variation in tree or shrub community composition

Neither aggregated measures of residential socio-economic status nor parcel scale measures of economic value and the built environment adequately explain variation in tree and shrub community composition on office developments (Table @\ref(tab:TAB-all-PERMANOVA)). 
For the tree community, Median Income is significant before, though not after, using the Holm-Bonferroni correction for multiple comparisons. 
All other variables for both tree and shrub communities are not significant before or after correction.

Generally, this supports my hypothesis that aggregated socio-economic variables specific to residential property are not important for commercial properties as well [@hope2003; @leong2018]. 
Additional research is needed to determine if there is a relationship between Median Income and the tree community or if it is an artifact of multiple comparisons.
For aggregated socio-economic variables to be significant drivers of vegetation on office developments, the surrounding socio-economic context would need to influence developer and landowner choices of trees and shrubs. 
This could occur in areas where office developments are adjacent and visible to residential property. 
However, zoning code in Bellevue and Redmond---as in much of the United States---actively separates and screens the different land uses from one another. 

Instead, owners of office developments are likely signalling to prospective and existing tenants [@laverne2003; @levy2013], in contrast with owners of residential properties, who use vegetation choices to signal to their neighbors of similar socio-economic status [@nassauer2009; @cook2012; @peterson2012]. 
Studies examining why decision makers on commercial property make planting decisions are fewer in number than residential homeowners, though existing studies provide important early insight. 
For example, in Toronto factors like site aspect, appearance, and available space rated more highly in species selection than whether species are native or nearby canopy composition for landscape architects, however city staff tried to plant native species whenever possible [@conway2016].
Additional research is needed to link decision makers' personal values and aesthetic preferences, economic motivations, and social norms with tree and shrub community composition on commercial land following work on residential property by @cook2012 and @shakeel2014.

Parcel scale measures of economic value and the built environment not significant in explaining variation in tree or shrub community composition include site age, building quality (proxy for rent extraction), and assessed land value (land rent gradient). These results fail to support my hypothesis. Previous research found that property value explained variation in the woody vegetation community [@mills2016]. Similarly, site age was suggested as a determinant of woody vegetation community composition by studies on residential properties [@boone2010; @avolio2018], landscaping professionals I interviewed, and my examination of contemporaneous landscaping plans filed with the cities of Bellevue and Redmond. Landscaping professionals mentioned trends in plant popularity, including _Pieris japonica_ (Thunb.) D. Don ex G. Don in the late 1980s and increasing use of native plants since 2000. Alternative explainations for this finding include: building age is a poor measure for landscaping age due to replanting; an interaction between age and landscaping budget; or that a subset of office developments are planted with in vogue landscape plants, such as the common but undersampled "Medium" (MM) group. 

Differences in study design may also be responsible for these divergent results. 
Other studies use index response variables with univariate regression [@hope2003; @martin2004], measures dependent on effort [@karlik2001; @martin2004], and plot or transect designs which confound different actors and outcomes [@biyrbe2013].


```{r TAB-all-PERMANOVA}

# need to include Pseudo-F, p-value, AICc

AICc.all.shrub$Model <- c("Area (acres)", "Percent Foreign-Born", "Town", "Median Income", "Impervious w/in 500 m (%)", "Building Age (in 2017)", "Building Quality", "Appraised Land Value per Acre", "Small and Medium Height Vegetation Cover", "Tall Vegetation Cover", "Tree cluster", "Dead Wood (count)", "Median Height of Dominant Conifer", "Stands Predate Development", "Density of Native COnifers") 
AICc.all.shrub$`Adjusted p-val` <- p.adjust(AICc.all.shrub$`p-value`, "holm")

AICc.all.tree$Model <- c("Area (acres)", "Percent Foreign-Born", "Town", "Median Income", "Impervious w/in 500 m (%)", "Building Age (in 2017)", "Building Quality", "Appraised Land Value per Acre", "Small and Medium Height Vegetation Cover", "Tall Vegetation Cover", "Dead Wood (count)")
AICc.all.tree$`Adjusted p-val` <- p.adjust(AICc.all.tree$`p-value`, "holm")


AICc.all.tree <- rbind(AICc.all.tree, rep(NA,9), rep(NA,9), rep(NA,9), rep(NA,9))


socio.economic.results <- cbind(AICc.all.shrub[ , c(6,3,4,9,2,7)], AICc.all.tree[ , c(3,4,9,2,7)])
socio.economic.results[ , 2:10] <- round(socio.economic.results[ , 2:10], 2)

colnames(socio.economic.results) <- c("Model", "Shrub Pseudo-_F_","Shrub p-value",
                                      "Shrub Adjusted p-val", "Shrub AICc","Shrub Delta AICc",
                                      "Tree Pseudo-_F_","Tree p-value",
                                      "Tree Adjusted p-val", "Tree AICc","Tree Delta AICc")
options(knitr.kable.NA = '')
knitr::kable(socio.economic.results,
             caption = "",
             format = "pandoc", escape = TRUE, 
             digits = 2, 
             format.args = list(decimal.mark = '.', big.mark = ","))

```



## Development and landscaping outcomes are related to tree and shrub community composition

Development and landscaping outcomes are related to tree and shrub community composition, the Native Tree cluster, and the first NMDS axis (Figure \@ref(fig:FIG-tree-management-NMDS)). 
Convex hulls and fitted environmental vectors found strong relationships with median dominant native conifer height (a proxy for stand age), native conifer density, the presence of stands predating development, and dead wood abundance (particularly stump abundance). 
These outcome variables also explained variability in the shrub community using PERMANOVA. 
The best supported models included median dominant native conifer height, Native vs. Ornamental Tree cluster membership, native conifer density, and the presence of stands predating development (Table \@ref(tab:TAB-shrub-model-comparison)). 
Together, these results support my hypothesis that development and landscaping actions impact vegetation communities on office developments. 
These results also agree with clustering results to suggest that a suite of decisions is being made that results in either retaining more trees and planting native shrubs or retaining fewer trees and planting ornamental trees and shrubs.

However, development and landscaping outcomes are the end point of economic decision making processes poorly studied in urban ecology.
Though the coarse socio-economic variables examined here were not significant, developer and landowner motivations and decision making were not considered explicitly, only their outcomes. 
To reach these end points, developers may consider ease of construction based on site conditions, relative cost of different construction approaches, preferences of the landowner and customer specifications, previous company experience or company aesthetic, and development regulations [which impose costs on developers; @conway2016; @grimes2015; @hakkinen2011; @nappi2006; @dorney1984].
As mentioned, the intended audience of prospective and existing tenants may influence both development and landscaping decisions [@laverne2003; @levy2013].
These considerations may influence financing available to developers, financial risk, and the appeal of and thus demand for the completed project [@laverne2003].
Further, when considering multiple competing options---such as different landscaping choices---developers and landowners may satisfice [@mohamed2009].
That is, they search through alternatives until one meets an acceptability threshold, and that is the option chosen.
Additional research on motivations leading to certain development and landscaping outcomes on commercial land uses is needed.


```{r FIG-tree-management-NMDS, fig.cap = '(ref:NMDS)', fig.height=6.5, fig.width=6.5}

  spd.col <- ifelse(management.landscaping$stand.predate.development == "yes", "black", "gray70")
      


      par(mfrow = c(2,2), mar = c(2,3,2,1))
      
      temp <- ordisurf(NMDS.tree.2d ~ management.landscaping$height.m.median, plot = F)
        plot(temp, ylab = "NMDS2", xlab = "")
        points(NMDS.tree.2d,
               display = "sites", 
               cex = 1.2, pch = 16)
        ordihull(NMDS.tree.2d, 
                 groups = vegetation.clusters$tree.cluster.name,
                 col = "gray",
                 draw = "polygon", 
                 label = TRUE,
                 alpha = .2)
        #plot(envfit(NMDS.tree.2d, management.landscaping$height.m.median),  labels = "")
      title(main = "Median Domin. Native Conif. Ht. (m)")
      
      temp <- ordisurf(NMDS.tree.2d ~ management.landscaping$tree.conifer.nat.dens,
               plot = F)
        plot(temp, ylab = "NMDS2", xlab = "")
        points(NMDS.tree.2d,
               display = "sites",
               cex = 1.2,
               pch = 16)
        ordihull(NMDS.tree.2d,
                 groups = vegetation.clusters$tree.cluster.name,
                 col = "gray", draw = "polygon",
                 label = TRUE, alpha = .2)
        #plot(envfit(NMDS.tree.2d, management.landscaping$tree.conifer.nat.dens),  labels = "")
      title(main = "Native Conifer Density")

      temp <- plot(NMDS.tree.2d, ylab = "NMDS2",
           xlab = "NMDS1", display = "sites")
          points(NMDS.tree.2d, display = "sites",
                 col = spd.col, cex = 1.2, pch = 16)
          ordihull(NMDS.tree.2d, groups = vegetation.clusters$tree.cluster.name,
                   col = "gray", draw = "polygon",
                   label = TRUE, alpha = .2)
          #plot(envfit(NMDS.tree.2d, data.frame(as.factor(management.landscaping$stand.predate.development)),
          #           na.rm = T), labels = c("No SPD", "Yes SPD"))
      title(main = "Stands Predating Development")
      
      temp <-
          ordisurf(NMDS.tree.2d ~ management.landscaping$dead.wood,
                   plot = F)
          plot(temp, ylab = "NMDS2", xlab = "NMDS1")
          points(NMDS.tree.2d,
                 display = "sites",
                 cex = 1.2,
                 pch = 16)
          ordihull(NMDS.tree.2d,
                   groups = vegetation.clusters$tree.cluster.name,
                   col = "gray",
                   draw = "polygon",
                   label = TRUE,
                   alpha = .2
                  )
          # plot(envfit(NMDS.tree.2d, data.frame(management.landscaping$dead.wood, 
          #                                      management.landscaping$Stump.count,
          #                                      management.landscaping$Snag.count)),  
          #      labels = c("Total", "Stumps", "Snags"))
          title(main = "Dead Wood Abundance")


```

(ref:NMDS) Two dimensional NMDS representation of tree community composition. Median dominant native conifer height, native conifer density, and the presence of stands predating development are associated with the first NMDS axis. Dead wood is associated with both axes. Black dots represent sites with stands predating development, gray dots sites without. Ordination has not been rotated prior to plotting.


```{r TAB-shrub-model-comparison}
colnames(shrub.model.summary)[2] <- "AICc Value"
colnames(shrub.model.summary)[3] <- "Pseudo-F"

temp <- shrub.model.summary[ 1:10, c(6, 3, 4, 2, 7)] 
temp <- temp[ order(temp$`Pseudo-F`, decreasing = T), ]

knitr::kable(temp,
       digits = c(1,3,5,2,2),
       caption = "PERMANOVA model summary comparing multivariate models of shrub community composition. Note that none of the models explain more than 25% of the variation in shrub community composition.",
             format = "pandoc", escape = TRUE,
       format.args = list(decimal.mark = '.', big.mark = ","))

```


## Implications for urban habitat quality and quantity

The variation in woody vegetation communities I observed on office developments suggests that better habitat conservation during and following development is possible using currently existing developements as models. 
As local biological communities are largely determined by this vegetation, sites with more trees preserved and a greater abundance of native conifers likely provide higher habitat quality and quantity to other organisms [@wittig2010; @mckinney2002; @faeth2011; @avolio2018; @faeth2005] as native vegetation is more likely to support native insects and native birds than ornamental plantings [@belaire2014; @chong2014; @pennington2011; @paker2014; @narango2018; @burghardt2009; @dysonPhD].
One estimate suggests native vegetation volume must be above 70% in order to maintain populations of native insectivorous bird species [@narango2018]; sites with high numbers of trees preserve likely already hit this target.
Further research should expand existing research to encompass all urban land use types, and investigate the mechanistic links between landscape patterns and processes at both site- and landscape-scales.

We can point to actions and policies more likely to contribute high quality habitat and benefit other trophic levels, including tree preservation policies, promoting native tree and shrub planting, and removing policy barriers to native vegetation [@dysonPhD; @threlfall2017]. 
However, the motivations driving exemplary adoption of these actions are currently opaque. 
Anecdotes shared during fieldwork suggest owner-occupied office space, cost, and personal values and connections to nature may be important factors in determining development and landscaping actions, as with homeowners [@goddard2013; @nassauer1993; @kiesling2010; @kendal2012; beumer2018; @helfand2006; @peterson2012].
Further research should attempt to better understand developer and landowner decisionmaking in order to improve habitat quality and quantity on commercial property [@uren2015]. 
These include interviews to better understand tree preservation and planting motivations [@hakkinen2011; @conway2016]; aesthetic preference studies as on residential developments [@larson2009; @harris2012]; and tracing decision making pathways based on previous land use [@yang2017].

## Implications for future urban ecology research.

> make section more concise.

Both the heterogenity I observed within one land use and the differences in importance of socio-economic variables between land uses have important implications for urban ecology research.
In a system with heterogeneity within one land use, the choice of sampling design can result in very different conclusions when comparing different land uses or examining one land use across the urban gradient [e.g. @blair1999; @bourne2013]. 

Consider a small random sample of the entire population of 405 office developments in Bellevue and Redmond for a study studying trees across multiple land uses. 
As the probability of selecting Ornamental Tree sites is much higher (~80%), this sample will most likely contain all or almost all sites in this group.
There is a low probability of sampling the ecological communities found on Native Tree sites.
If we consider the number of trees per site, the sample would not capture the fat right tail of sites with very high tree abundance (Figure \@ref(fig:FIG-extrapolated-dist)).
This sample could lead to misleading conclusions about the range of vegetation communities on office developments alone or in comparison with other land uses, and potential sollutions already extant on the landcape may be overlooked [@mcintyre2000urban].
Researchers should choose their sampling strategy carefully based on research questions and the underlying distribution of key variables in urban contexts with long environmental gradients [@mcintyre2000urban; @ellis1997; @telford2011].
If the phenomena of interest is related to vegetation structure or community composition, you must search out sites representing all vegetation types to measure the entire gradient instead of sampling only along an urban gradient [@lerman2011]. 

```{r FIG-extrapolated-dist, fig.cap = '(ref:extrapolate)'}

vc.mean <- mutate(sample.covariates,
                       tot.abund = rowSums(matrify.tree.sp.only)) %>%
    group_by(vegetation_class) %>%
    summarise_at(.vars = c("tot.abund"),
                 .funs = funs(treeab.mean = mean, treeab.sd = sd))

pop.tree.extrap <- merge(population.covariates, vc.mean, 
                         by = "vegetation_class", sort = F)

library(ggplot2)

jitter <- jitter(pop.tree.extrap$treeab.mean,
                                   pop.tree.extrap$treeab.sd)
jitter[jitter<1] <- 1

ggplot(pop.tree.extrap, aes(jitter)) + 
    geom_freqpoly(bins = 40) +
    labs( x = "Tree Abundance per Site", 
                            y = "Number of Sites",
                            title = "Tree Abundance on Office Developments"
    ) +
    scale_x_continuous(limits = c(0,max(jitter)+5))


```

(ref:extrapolate) Extrapolated distribution of the number of trees on office developments based on observed mean and standard deviations for each vegetation class used in sampling (HH, MC, MD, MM, LL).




Additionally,
> need to point out all results supporting this--different likely audience, different drivers

The mismatch in vegetation community response to specific socio-economic drivers means that urban ecologists cannot assume that the same variables explain variation for all land use types equally. 
Each land use type may need to be modeled independently, and modeling all land uses within a city is likely inaccurate if you assume all land uses respond equivalently. 
Commercial developers and landowners are likely driven by different motivations, including ease of construction based on site conditions, cost, and development regulations. Studies examining why landscape architects make planting decisions are fewer in number than residential homeowners. 
>In Toronto, factors like site aspect, appearance, and available space rate more highly in species selection than whether species are native and nearby canopy composition for landscape architects, however city staff try to plant native species whenever possible [@conway2016]. 
(think i use this sentence elsewhere)

Whether similar patterns hold true in the Pacific Northwest is unknown.







> This mismatch means that urban ecologists cannot assume that the same variables or mechanisms explain variation for all land use types, and this must be reflected in ecosystem models. 

> add shakeel--discussion of individual preferences over neighborhood aggregated socio-economic classifiers

> inequity may be perpetuated on office developments b/c unexamined LP properties more likely to be strip mall retail; more research needed re: salary and surrounding green.














# Conclusion

> Conclusion is weak. Need to provide better overview of results and main things learned.

I found that developments in Bellevue and Redmond, Washington, are heterogenous with distinct Native and Ornamental Tree and Shrub vegetation communities. My research provides a counterpoint to residential land use studies that found neighborhood socio-economic conditions important in determining vegetation communties. This research also provides evidence that different development and landscaping choices meaningfully influence urban vegetation and result in this divergent community composition across office developments. Future research needs to examine motivations behind these choices in order to improve the quality and quantity of habitat available in urban ecosystems. 



# Supplemental Table 1: Trees

```{r TAB-all-trees}


alltree <- merge(descriptive.stats.tree.sp, tree.native,
              by.x = "species.name", by.y = "tree.species") %>%
        arrange(., tree.scientific)

alltree$species.range <- paste0(alltree$species.min, "--", alltree$species.max)
alltree$tree.origin.update <- ifelse(alltree$tree.origin.update %in% c("non.native", "non-native"),
                           "Non-native", 
                           ifelse(alltree$tree.origin.update == "native",
                                  "Native",
                                  ifelse(alltree$tree.origin.update == "ambiguous",
                                         "Both planted w/croses",
                                         alltree$tree.origin.update)))



PA.tree.sp.only <- PA.tree.sp.only[ , match(alltree$species.name, colnames(PA.tree.sp.only))]
    colnames(PA.tree.sp.only) == alltree$species.name

alltree$tree.incidence <- colSums(PA.tree.sp.only)


knitr::kable(alltree[ , c("tree.scientific",
                          "tree.origin.update",
                          "tree.incidence",
                           "species.range",
                           "species.total.abundance",
                           "species.mean.abundance",
                           "species.abundance.sd")], 
             col.names = c("Taxa", "Origin",
                           "No. Sites Found",
                           "Abundance Range",
                           "Total Abundance",
                           "Mean Abundance",
                           "Abundance SD"),
             row.names = FALSE,
             caption = "All tree species observed.",
             format = "pandoc", escape = TRUE, 
             format.args = list(decimal.mark = '.', big.mark = ",", digits = 2))

```

# Supplemental Table 2: Shrubs

```{r TAB-all-shrubs}

allshrub <- merge(descriptive.stats.shrub.sp, shrub.native,
              by.x = "species.name", by.y = "shrub.scientific.update") %>%
        arrange(., species.name) %>%
        distinct(species.name, .keep_all = TRUE)

allshrub$species.range <- paste0(allshrub$species.min, "--", allshrub$species.max)
allshrub$shrub.origin <- ifelse(allshrub$shrub.origin == "non-native",
                           "Non-native",
                           ifelse(allshrub$shrub.origin == "native",
                                  "Native",
                                  ifelse(allshrub$shrub.origin == "ambiguous",
                                         "Both planted w/crosses",
                                         allshrub$shrub.origin)))

frequency.shrub <- tibble(species.name = names(colSums(PA.shrub.site)),
                          frequency.shrub = colSums(PA.shrub.site) )

frequency.shrub$species.name == allshrub$species.name


allshrub$incidence <- frequency.shrub$frequency.shrub


knitr::kable(allshrub[ c(1:72,80:85,73:79),
                       c("species.name",
                         "shrub.origin.update",
                         "incidence",
                         "species.range",
                      "species.total.abundance",
                      "species.mean.abundance",
                      "species.abundance.sd")],
             col.names = c("Taxa", "Origin",
                           "No. Sites Found",
                           "Abundance Range",
                           "Total Abundance",
                           "Mean Abundance",
                           "Abundance SD"),
             row.names = FALSE, 
             caption = "All shrub species observed.",
             format = "pandoc", escape = TRUE, 
             format.args = list(decimal.mark = '.', big.mark = ","))
```




# Works Cited
