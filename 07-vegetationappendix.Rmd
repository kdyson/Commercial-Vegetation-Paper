```{r CH7-SETUP, include=FALSE, echo = FALSE}

knitr::opts_chunk$set(
    echo = FALSE,
    warning = FALSE,
    message = FALSE,
    fig.align = "center",
    cache = FALSE,
    fig.pos = "H"
    )

## Load sourced R codes
all.current <- TRUE

if (all.current == TRUE) {

    load(file = "../Vegetation/vegetation_data_analysis_complete_12052018.RData")

}

if (all.current == FALSE) {
    # This takes a few hours.
    source("../Vegetation/vegetation_data_analysis.R")
    
}    

setwd("../DissertationBookdown/")

## Load required libraries
    library(ggplot2)
    library(rgl)
    library(pander)
    library(gridExtra)
    library(ggrepel)
    library(tibble)
    library(vegan)
    library(dplyr)
    library(knitr)
    library(kableExtra)


    options(digits = 3)


    
    
    neighborhood.veg <-
    read.csv(
    "../../DataRepository/SiteData/dissolved_parcel_neighborhood_veg.csv",
    stringsAsFactors = FALSE
    )
    
```

\pagestyle{headings}
\raggedbottom
\setstretch{1.65}

# (APPENDIX) Appendix {-}

# Vegetation {#CH07-vegetationappendix}


## Master set of interview questions

The following questions were used for elite interviews of land owners and landscape maintenance professionals.

* Where do these activities take place?
* How long are landscapers on site?
* What are your typical maintenance activities at this property (weekly, monthly, seasonally)?
    * This question is meant to help guide the following more detailed questions.
* Where on the property do you perform these activities?
    * Examples: lawn, border ornamentals, etc.
* How often do you weed manually?
* Do you uproot/disturb mushrooms when you find them?
* How often do you apply herbicide, and how much? (rough measure e.g. frequent/rarely/never, H/M/L)
    * Same question repeated for fertilizer, fungicide, and insecticide.
* How do you decide when to apply (fertilizer, herbicide, fungicide, insecticide)? 
    * Is (fertilizer, herbicide, fungicide, insecticide) at a set rate per month/season? 
    * If not, are there criteria used? 
* Do you use supplemental irrigation? 
    * Is the irrigation system on a timer?
    * Criteria for application if not?
* How often do you apply mulch, what type, and how much?
    * Criteria for application?


\newpage

## Full tree species list

```{r CH7-all-trees, fig.cap="All tree species observed."}

temp <- merge(descriptive.stats.tree.sp, tree.native,
              by.x = "species.name", by.y = "tree.species") %>%
        arrange(., tree.scientific)

temp$species.range <- paste0(temp$species.min, "--", temp$species.max)
temp$tree.origin <- ifelse(temp$tree.origin == "non.native",
                           "Non-native", 
                           ifelse(temp$tree.origin == "native",
                                  "Native",
                                  ifelse(temp$tree.origin == "ambiguous",
                                         "Ambiguous",
                                         temp$tree.origin)))



# knitr::kable(temp[ , c("tree.scientific", "tree.common", "tree.origin", "species.range", "species.total.abundance", "species.mean.abundance", "species.abundance.sd", "species.incidence")], 
#              col.names = c("Taxa", "Common Name", "Origin", "Abundance Range", "Total Abundance", "Mean Abundance", "Abundance SD", "Taxa Incidence"))  

knitr::kable(temp[ , c("tree.scientific", "tree.common", "tree.origin", "species.total.abundance", "species.mean.abundance", "species.abundance.sd")], 
             col.names = c("Taxa", "Common Name", "Origin", "Total Abundance", "Mean Abundance", "Abundance SD"),
             row.names = FALSE,
             longtable = T, booktabs = T,
             "latex") %>%
    kable_styling(full_width = T,
      latex_options = c("striped"),
      font_size = 10) %>%
    column_spec(4:6, width = "4em")

```



\newpage

## Full shrub species list


```{r CH7-all-shrubs, fig.cap="All shrub species observed."}

temp <- merge(descriptive.stats.shrub.sp, shrub.native,
              by.x = "species.name", by.y = "shrub.species") %>%
        arrange(., shrub.scientific)

temp$species.range <- paste0(temp$species.min, "--", temp$species.max)
temp$shrub.origin <- ifelse(temp$shrub.origin == "non-native",
                           "Non-native", 
                           ifelse(temp$shrub.origin == "native",
                                  "Native",
                                  ifelse(temp$shrub.origin == "ambiguous",
                                         "Ambiguous",
                                         temp$shrub.origin)))



# knitr::kable(temp[ c(1:67, 77:80, 68:76), c("shrub.scientific", "shrub.common.pretty", "shrub.origin", "species.range", "species.total.abundance", "species.mean.abundance", "species.abundance.sd", "species.incidence")], 
#              col.names = c("Taxa", "Common Name", "Origin", "Abundance Range", "Total Abundance", "Mean Abundance", "Abundance SD", "Taxa Incidence"))  
knitr::kable(temp[ c(1:67, 77:80, 68:76), c("shrub.scientific", "shrub.common.pretty", "shrub.origin", "species.total.abundance", "species.mean.abundance", "species.abundance.sd")], 
             col.names = c("Taxa", "Common Name", "Origin", "Total Abundance", "Mean Abundance", "Abundance SD"),
             row.names = FALSE,
             longtable = T,
             booktabs = T,
             "latex") %>%
    kable_styling(full_width = T,
      latex_options = c("striped"),
      font_size = 10) %>%
    column_spec(4:6, width = "5em") %>%
    column_spec(1, width = "8em")

```


\pagebreak

## Observed sample and population distributions

My sampling design was stratified by assigned vegetation class and bounded by two independent variables---parcel area and percent impervious surface within 500 m of the parcel. Therefore:

1. vegetation class of the sample should be more evenly distributed than the vegetation class of the population (Figure \@ref(fig:CH7-vegetation-class-comparison));
2. the parcel area of the sample should be both a subset of the area of the population have a larger median (bounded 25-85% of size distribution; Figure \@ref(fig:CH7-site-comparison));
3. the percent impervious surface of the sample should be from a narrower distribution but centered around the same mean as the percent impervious surface of the population (bounded 15-85% of distribution; Figure \@ref(fig:CH7-site-comparison)); and
4. for all other independent variables describing the parcels, the sample should reflect the distribution of the broader population (Table \@ref(tab:CH7-covariate-summary)). 

Overall, my disproportionate stratified random sample achieved good coverage of the vegetation gradient on office developments. Except for site area, which is larger for the sample than the population, other independent variables have similar means for sample and population. However, the small sample size (20 sites) results in not sampling across some socio-economic gradients.


``` {r CH7-vegetation-class-comparison, out.width='80%', fig.cap='(ref:point1)'}

ggplot(VegClass) + geom_bar(aes(bin, Proportion, fill = factor(VegClass)), stat = "identity") + 
                    scale_fill_brewer(palette = "Spectral", name = "Vegetation Class:") +
                    theme(legend.position = "top", axis.title.x = element_blank())

```

(ref:point1) Point 1: Vegetation class of the sample is more evenly distributed than that of the population.

``` {r CH7-site-comparison, out.width='80%', fig.cap='(ref:point23)'}
      # removed 

population.covariates.act <-
    population.covariates[!(population.covariates$vegetation_class %in% c("WW", "XX", "LP")),]

population.area <-
    data.frame(
    population.area = population.covariates.act$acres,
    population.area.rank = rank(population.covariates.act$acres),
    in.sample = population.covariates.act$in.sample
    )


population.area$population.area.ctle <-
    population.area$population.area.rank / max(population.area$population.area.rank)

population.area$dist.to.smedian <-
    abs(population.area$population.area - median(sample.covariates$acres))

p1 <- ggplot() + geom_point(data = population.area, aes(population.area.ctle, population.area, color = in.sample), alpha = .6, size = 3) +
    geom_point(data = subset(population.area, in.sample == "Y"),
               aes(population.area.ctle, population.area, color = in.sample), size = 3) +
    geom_vline(xintercept = c(.15,.25, .85), linetype = "dotted") +
    geom_vline(xintercept = c(.5, population.area$population.area.ctle[which(population.area$dist.to.smedian ==
                                                                           min(population.area$dist.to.smedian))]),
               linetype = "dashed", color = c("gray30", "orange")) +
        scale_color_manual(values = c("gray30", "orange"), name = "In Sample:") + scale_y_log10() +
        labs(x = "Rank Area (percentile)", y = "Area (acres, log10)")

remove(population.area)

pop.impervious <-
    data.frame(
    pop.impervious = population.covariates.act$dissolved_parcel_500m_buffer_impervious_500m_mean,
    pop.impervious.rank = rank(
    population.covariates.act$dissolved_parcel_500m_buffer_impervious_500m_mean
    ),
    in.sample = population.covariates.act$in.sample
    )
    pop.impervious$pop.impervious.ctle <-
    pop.impervious$pop.impervious.rank / max(pop.impervious$pop.impervious.rank)
    pop.impervious$dist.to.smedian <-
    abs(pop.impervious$pop.impervious -
    median(sample.covariates$dissolved_parcel_500m_buffer_impervious_500m_mean))

p2 <- ggplot() + geom_point(data = pop.impervious, aes(pop.impervious.ctle, pop.impervious, color = in.sample), alpha = .6, size = 3) +
    geom_point(data = subset(pop.impervious, in.sample == "Y"),
               aes(pop.impervious.ctle, pop.impervious, color = in.sample), size = 3) +
    geom_vline(xintercept = c(.15, .85), linetype = "dotted") +
    geom_vline(xintercept = c(.5, pop.impervious$pop.impervious.ctle[which(pop.impervious$dist.to.smedian ==
                                                                           min(pop.impervious$dist.to.smedian))]),
               linetype = "dashed", color = c("gray30", "orange")) +
        scale_color_manual(values = c("gray30", "orange"), name = "In Sample:") +#scale_y_log10() +
        labs(x = "% Impervious Surface (percentile)", y = "% Impervious Surface (500m, log10)")

remove(pop.impervious)


library(gridExtra)
grid.arrange(p1, p2)

```

(ref:point23) (L) Point 2: Parcel area of the sample is appropriately bounded and has a larger median than that of the population. (R) Point 3: Surrounding % impervious surface of the sample is appropriately bounded and has approximately the same median as that of the population (500 m mean value buffered on parcel outline).


```{r CH7-covariate-summary, out.width='80%'}

temp <- data.frame(matrix(unlist(pretty.descriptive.covariates), nrow = 10, byrow = FALSE), stringsAsFactors = FALSE)
colnames(temp) <- colnames(pretty.descriptive.covariates)
temp[ , 4:6] <- lapply(temp[ , 4:6], as.numeric) %>%
                    lapply(., round, digits = 2)
temp[ c(1:4, 7:10), 2:3] <- lapply(temp[ c(1:4, 7:10), 2:3], as.numeric) %>%
                    lapply(., round, digits = 2)


knitr::kable(temp[ c(1:10), ],
             booktabs = TRUE,
             caption = "(ref:point4)") %>%
    kable_styling(full_width = F,
      latex_options = c("striped"),
      font_size = 10) 

```

(ref:point4) Point 4: Summary statistics for independent variables for both the population of business parks in Redmond and Bellevue and the sample of sites studied. Area (acres) and year built (transformed to building age) are site-scale covariates, while the others are neighborhood-scale covariates. Sites were selected based on area and percent impervious. Median income ($) and % foreign born are included as they were significant in residential research and to see if commercial developments follow similar patterns or are influenced by surrounding residential property.


```{r CH7-categorical-covariate-graphs, fig.cap="(ref:point4b)", include = F}

p2 <-
    ggplot(Town) + geom_bar(aes(bin, Proportion, fill = Town), stat = "identity") +
    scale_fill_brewer(
    palette = "Spectral",
    name = "Town:",
    labels = c("Bellevue", "Redmond")
    ) +
    theme(legend.position = "right", axis.title.x = element_blank())

p3 <-
    ggplot(BldQual) + geom_bar(aes(bin, Proportion, fill = BldQual), stat = "identity") +
    scale_fill_brewer(
    palette = "Spectral",
    name = "Building Quality:",
    labels = c("Good/Exc", "Good", "Avg/Good", "Avg", "Low/Avg", "Low")
    ) +
    theme(legend.position = "right", axis.title.x = element_blank())
    
    grid.arrange(p2, p3, nrow = 1)
    
    #(ref:point4b)  Point 4: Comparison of Population and Sample distribution of parcel town and building quality. Building quality is assigned by the King County Assessor's office.
        
```


\newpage

## Shrub and tree diversity indicies

I found variation in the species richness (number of species per site) and evenness ( $H'/log_{10}(richness)$ ) between sites. Effective species richness is higher and more variable for shrubs than trees, and evenness is generally higher and less variable for shrubs than trees. This suggests that shrub species are usually planted evenly at business developments, though how many species are planted varies widely. There there are consistently only a few tree species at business developments, but the sites vary greatly in how evenly these species are distributed. 



```{r IndicesCalc, fig.width = 7, fig.height = 3, fig.cap = "Comparison of shrub and tree diversity indices."}

shrub.stats <- data.frame(
        sp.richness = apply(matrify.shrub.site, MARGIN = 1, specnumber),
        shannon = apply(matrify.shrub.site, MARGIN = 1, diversity),
        type = rep(x = "shrub")
    )
    shrub.stats$evenness <- shrub.stats$shannon / log(shrub.stats$sp.richness)
    shrub.stats$esr <- exp(shrub.stats$shannon)
    
    tree.stats <- data.frame(
        sp.richness = apply(matrify.tree.sp.only, MARGIN = 1, specnumber),
        shannon = apply(matrify.tree.sp.only, MARGIN = 1, diversity),
        type = rep(x = "tree")
    )
    tree.stats$evenness <- tree.stats$shannon / log(tree.stats$sp.richness)
    tree.stats$esr <- exp(tree.stats$shannon)
    tree.stats$conifer.count <-
    matrify.tree.sp.only$douglas.fir + matrify.tree.sp.only$western.hemlock +
    matrify.tree.sp.only$western.red.cedar
    
    veg.stats <- rbind(shrub.stats, tree.stats[, 1:5])
 
   
    
    
    p1 <-
    ggplot(data = veg.stats) + geom_dotplot(
    aes(type, esr, fill = type),
    binaxis = "y",
    stackdir = "center",
    alpha = .7,
    color = "gray15"
    ) +
    ylab("Effective Species Richness") + xlab("") + guides(fill = "none") + scale_fill_manual(values = c("gray25", "gray60"))
    
    # p2 <- ggplot(data = veg.stats) + geom_dotplot(aes(type, shannon, fill = type), binaxis = "y", stackdir = "center", alpha = .7,
    #                                               color = "gray15") +
    #     ylab("Shannon's Diversity") + xlab("") + guides(fill = "none") + scale_fill_manual(values = c("gray25", "gray60"))
    
    p3 <-
    ggplot(data = veg.stats) + geom_dotplot(
    aes(type, evenness, fill = type),
    binaxis = "y",
    stackdir = "center",
    alpha = .7,
    color = "gray15"
    ) +
    ylab("Evenness") + xlab("") + guides(fill = "none") + scale_fill_manual(values = c("gray25", "gray60"))
    
    grid.arrange(p1, p3, ncol = 2)
    
    
```


This pattern may be related to the preservation of existing native species during development. Sites with low tree evenness are more dominated by native conifers (L; both planted and preserved through development). The three key species are western red cedar ( _Thuja plicata_ ), Douglas fir ( _Pseudotsuga menziesii_ ), and western hemlock ( _Tsuga heterophylla_ ). However, the number of native conifers is not related to the site's tree species richness, suggesting that even sites dominated by native conifers are generally planted with multiple ornamental tree species (R).

For these graphs and those that follow, note that the green line is a linear model estimation with the 95% confidence interval shown in gray. Where this confidence interval includes the horizontal line (constant y), the $H_{0} : slope = 0$ model cannot be rejected.


```{r tree-vs-conifer, warning = FALSE, fig.width = 6, fig.height = 2.5, fig.cap="Number of native conifers plotted with office development tree evenness and tree species richness"}

p1 <- ggplot(data = tree.stats, aes(x = evenness, y = conifer.count)) + geom_point() + 
    geom_smooth(method = "glm", color = "yellowgreen", alpha = .2) +
    labs(y = "Number of Native Conifers", x = "Tree Evenness") 
p2 <- ggplot(data = tree.stats, aes(x = esr, y = conifer.count)) + geom_point() + 
    geom_smooth(method = "glm", color = "yellowgreen", alpha = .2) +
    labs(y = "Number of Native Conifers", x = "Tree Richness") 
grid.arrange(p1, p2, ncol = 2)

```


For shrubs, there is no significant relationship between the abundance of native conifers and shrub evenness or richness. These one-dimensional indices suggest that shrub landscaping is independent of the number of native conifers---but note that they say nothing about the makeup of the shrub community. 


```{r shrub-vs-conifer, fig.width = 6, fig.height = 2.5, fig.cap="Number of native conifers plotted with office development shrub evenness and richness. Note that I removed one outlier site with extremely low shrub evenness due to high salal abundance to make this pattern more clear; it does not change the result."}

p1 <- ggplot() + geom_point(aes(y = tree.stats$conifer.count[-which(rownames(tree.stats)=="Eastgate")], 
                                x = shrub.stats$evenness[-which(rownames(shrub.stats)=="Eastgate")])) + 
    geom_smooth(aes(y = tree.stats$conifer.count[-which(rownames(tree.stats)=="Eastgate")], 
                    x = shrub.stats$evenness[-which(rownames(shrub.stats)=="Eastgate")]),
                method = "lm", color = "yellowgreen", alpha = .2) +
    labs(y = "Number of Native Conifers", x = "Shrub Evenness")

p2 <- ggplot() + geom_point(aes(y = tree.stats$conifer.count, x = shrub.stats$esr)) + 
    geom_smooth(aes(y = tree.stats$conifer.count, x = shrub.stats$esr), 
                method = "lm", color = "yellowgreen", alpha = .2) +
    labs(y = "Number of Native Conifers", x = "Shrub Richness")

grid.arrange(p1, p2, ncol = 2)

```


Within sites, shrub species evenness and richness and tree species evenness and richness are not related. Additionally, there is no relationship between shrub and tree effective species richness, or tree and shrub evenness.



```{r even-vs-rich, include = FALSE, fig.width = 6, fig.height = 2.5}

p2 <- ggplot(data = tree.stats, aes(x = evenness, y = esr)) + geom_point() + 
    geom_smooth(method = "lm", color = "yellowgreen", alpha = .2) +
    labs(y = "Tree Richness", x = "Tree Evenness") 
p1 <- ggplot(data = shrub.stats, aes(x = evenness, y = esr)) + geom_point() + 
    geom_smooth(method = "lm", color = "yellowgreen", alpha = .2) +
    labs(y = "Shrub Richness", x = "Shrub Evenness")
grid.arrange(p1, p2, ncol = 2)

```



\newpage

## Comparing assigned vegetation classes 

I used ANOVA to compare vegetation classes assigned during site selection with observed tree and shrub data (density of large native conifers and shrub species richness) using the aov {stats} function. For native tree density, I set up ANOVA contrasts to test the difference between all vegetation classes, between pooled LL/MM/MD and MC/HH classes, between LL/MM/MD and between MC/HH[^contrasts]. For effective shrub species richness, I set up ANOVA contrasts between pooled LL/MM/MC and MD/HH classes and within classes.

[^contrasts]:I used contrasts instead of Tukey HSD because it is appropriate for a priori comparisons and has more power.

As expected, conifer density on 'High' and 'Medium Canopy' sites is significantly greater than 'Low', 'Medium', and 'Medium Diverse' sites (contrast Pr( >|t|) = `r round(tree.aov$coefficients[2,4], 4)`). The two outliers in the 'Medium Diverse' and 'Low' categories resulted from initial classification errors and highlight the difficulty of rapid classification in urban areas with uncertain boundaries^[The notable exception in the 'Medium Diverse' category had an undeveloped woodlot at the back of the property that was not easily visible during classification; the native conifers planted at the 'Low' site exception were ambiguously located at the boundary edge of the property. In hindsight, the LL outlier should have been classified MM and the MD outlier should have been classified as HH].

Shrub species richness was more similar across sites than expected, and no significant differences between groups were detected. With few exceptions, raw shrub species richness and effective species richness ranged between 10-25 species and 7-13 species, respectively [effective richness defined as exp(H'); @jost2006]. Effective shrub species richness on 'High' and 'Medium Diverse' sites was not statistically different than 'Low', 'Medium', and 'Medium Canopy' sites (contrast Pr( >|t|) = `r round(shrub.aov$coefficients[2,4], 3)`; Figure \@ref(fig:CH7-vegetation-class-groundtruth)). While the range of observed shrub richness suggest that the sites I surveyed have a broad enough range to draw conclusions about shrubs on office developments, there are few replicates with very high levels of shrub richness.

```{r CH7-vegetation-class-groundtruth, fig.cap="(ref:validationplot)", out.width="90%", fig.height=5}


# Plots showing that initial vegetation classification matches pretty well with
# what I observed for trees but not shrubs.
#
# I was kind of bad at tree sizes--so using ML to account for that.


    positions <- c("LL", "MM", "MD", "MC", "HH")
    conif.label <- c("a", "a", "a", "b", "b")

    p1 <- ggplot() + 
        geom_boxplot(aes(sample.covariates$vegetation_class,
                         descriptive.stats.site$tree.conifer.ML.nat.dens)) +
        geom_dotplot(aes(sample.covariates$vegetation_class,
                         descriptive.stats.site$tree.conifer.ML.nat.dens),
                     binaxis = "y",
                     alpha = .6,
                     stackdir = "center",
                     fill = "darkslategrey") +
        scale_x_discrete(limits = positions) +
        geom_text(aes(x = positions,
                      label = conif.label),
                  y = c(50,50,50,50,50)) +
        labs(title = "Vegetation Class: Ground Truthing Data",
             y = "Native Conifer Density\n(# large trees/acre)",
             x = "")
    
    p2 <- ggplot() + 
        geom_boxplot(aes(sample.covariates$vegetation_class,
                         descriptive.stats.site$shrub.effective.sp)) +
        geom_dotplot(aes(sample.covariates$vegetation_class,
                         descriptive.stats.site$shrub.effective.sp), 
                     binaxis = "y",
                     alpha = .6,
                     stackdir = "center",
                     fill = "darkslategrey") +
        scale_x_discrete(limits = positions) +
        labs(title = "",
             y = "Effective Shrub\nSpecies Richness",
             x = "Vegetation Class")

    grid.arrange(p1, p2)


```

(ref:validationplot) Comparison of vegetation classes assigned during site selection. (Top): As expected, native conifer density is significantly higher on Medium Canopy and High vegetation class sites. (Bottom): Contrary to expectations, effective shrub species richness was not significantly different across vegetation classes.

\newpage

## Vegetation rank abundance

Figure \@ref(tab:CH7-cluster-top10) shows the ten most abundant tree and shrub species for community groups identified using flexible-beta cluster analysis. Both native tree and shrub community typologies are dominated by native species like western red cedar, while non-native ornamentals largely from the eastern United States and Asia dominate the ornamental lists. Note that some species span both lists. For example, Douglas-fir are widely planted on both native and ornamental tree community typologies, but the relative abundance is greatly reduced in ornamental tree communities.

```{r CH7-cluster-top10, fig.pos='H'}

library(stringr)

names(tree.cluster.native) <- str_replace_all(names(tree.cluster.native), "\\.", " ")

names(tree.cluster.orndec) <- str_replace_all(names(tree.cluster.orndec), "\\.", " ")

names(shrub.cluster.native) <- str_replace_all(names(shrub.cluster.native), "\\.", " ")

names(shrub.cluster.cultiv) <- str_replace_all(names(shrub.cluster.cultiv), "\\.", " ")

temp <- tibble(
    `Rank` = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"),
    `Native Tree Group` = paste(names(head(tree.cluster.native, 10)), " (", head(tree.cluster.native, 10), ")" , sep = ""),
    `Ornamental Tree Group` = paste(names(head(tree.cluster.orndec, 10)),  " (", head(tree.cluster.orndec, 10), ")" , sep = ""),
    `Native Shrub Group` = paste(names(head(shrub.cluster.native, 10)), " (", head(shrub.cluster.native, 10), ")" , sep = ""),
    `Ornamental Shrub Group` = paste(names(head(shrub.cluster.cultiv, 10)), " (", head(shrub.cluster.cultiv, 10), ")" , sep = ""))

knitr::kable(temp,
             caption = "Rank abundance of tree and shrub species for each community group identified by flexible-beta analysis.", 
             row.names = FALSE,
             booktabs = T) %>%
kable_styling(full_width = F,
      latex_options = c("striped"),
      font_size = 10) %>%
    column_spec(2:5, width = "9em") %>%
    landscape()



```





\newpage

\pagebreak



## PERMANOVA simple multivariate regression results

Table \@ref(tab:PERMANOVA-shrub-results) shows all simple multivariate model results for shrub community composition, expressed as density (shrubs/acre).

``` {r PERMANOVA-tree-results, fig.pos = "H", include = F}

tree.PERMANOVA <- rbind(PERMANOVA.tree.groups,
                        PERMANOVA.socio.economic.tree.dens,
                        PERMANOVA.management.tree.dens
                        )


tree.PERMANOVA$pretty.names <- c(
        "Tree Community Cluster",
        "Vegetation Class",
        "Site Area (acres)",
        "Building Age (years)",
        "Building Quality",
        "Mean Impervious within 500 m (%)",
        "Town (Redmond/Bellevue)",
        "Assessed Land Value per Acre",
        "Median Household Income (USD)",
        "Foreign Born (%)",
        "Short and Medium Vegetation within 500 m (%)",
        "Tall Vegetation within 500 m (%)",
        "Fertilizer (Y/N)",
        "Herbicide (Y/N)",
        "Irrigation (Y/N)",
        "Mulch (Y/N)",
        "Mushroom (Y/N)"

)

colnames(tree.PERMANOVA)[c(1, 3, 4,6)] <-
    c("Variation Explained",
      "Pseudo-F",
      "p-value (Location)",
      "p-value (Dispersion)")

rownames(tree.PERMANOVA) <- tree.PERMANOVA$pretty.names


    tree.PERMANOVA[, 1:8] <- lapply(tree.PERMANOVA[, 1:8], as.numeric) %>%
                    lapply(., round, digits = 3)
    
knitr::kable(tree.PERMANOVA[ , c(1,3,4,6)], 
             booktabs = TRUE,
             row.names = T,
             caption = "Multivariate simple PERMANOVA model results for the tree community, expressed as density (trees/acre).") %>%
    kable_styling(full_width = F,
      latex_options = c("striped"),
      font_size = 10) %>%
    column_spec(2:5, width = "5em")


```



``` {r PERMANOVA-shrub-results, fig.pos = "H"}

shrub.PERMANOVA <- rbind(PERMANOVA.shrub.groups,
                        PERMANOVA.socio.economic.shrub.dens,
                        PERMANOVA.landscaping.shrub.dens,
                        PERMANOVA.management.shrub.dens
                        )

shrub.PERMANOVA$pretty.names <- c(
    "Shrub Community Cluster",
    "Vegetation Class",
    "Site Area (acres)",
    "Building Age (years)",
    "Building Quality",
    "Mean Impervious within 500 m (%)",
    "Town (Redmond/Bellevue)",
    "Assessed Land Value per Acre",
    "Median Household Income (USD)",
    "Foreign Born (%)",
    "Short and Medium Vegetation within 500 m (%)",
    "Tall Vegetation within 500 m (%)",
    "Dead Wood Abundance",
    "Median Douglas Fir Height (m)",
    "Stands Predate Development",
    "Tree Community Cluster",
    "Native Conifer Density",
    "Fertilizer (Y/N)",
    "Herbicide (Y/N)",
    "Irrigation (Y/N)",
    "Mulch (Y/N)",
    "Mushroom (Y/N)"

)

colnames(shrub.PERMANOVA)[c(1, 3, 4,6)] <-
    c("Variation Explained",
      "Pseudo-F",
      "p-value (Location)",
      "p-value (Dispersion)")

rownames(shrub.PERMANOVA) <- shrub.PERMANOVA$pretty.names


    shrub.PERMANOVA[, 1:8] <- lapply(shrub.PERMANOVA[, 1:8], as.numeric) %>%
                    lapply(., round, digits = 3)
    
knitr::kable(shrub.PERMANOVA[ , c(1,3,4,6)], 
             booktabs = TRUE,
             row.names = T,
             caption = "Multivariate simple PERMANOVA model results for the shrub community, expressed as density (shrubs/acre).") %>%
    kable_styling(full_width = F,
      latex_options = c("striped"),
      font_size = 10) %>%
    column_spec(2:5, width = "5em")


```
